from OpenAiGym.MinTermSrpobfEnv.MinTermSrpobfEnv import MinTermSrpobfEnv, ActionType
from stable_baselines3 import PPO, A2C, DQN, DDPG

from OpenAiGym.MinTermLpSrpobfEnv.MinTermLpSrpobfEnv import MinTermLpSrpobfEnv


from OpenAiGym.RLAlgorithmRunners.DqnRunner.DqnRunner import dqn_runner
metrics, envs=dqn_runner(5,"/home/oytun/PycharmProjects/research/OpenAiGym/MinTermSrpobfEnv/Data/5dim/DQN/2",[42,48])

from OpenAiGym.RLAlgorithmRunners.DqnRunner.DqnRunner import *
env4, model4 = dqn_runner_equivalent_functions(4,"/home/oytun/PycharmProjects/research/OpenAiGym/MinTermSrpobfEnv/Data/4dim/DQN/")
env = dqn_runner_equivalent_functions(3,"/home/oytun/PycharmProjects/research/OpenAiGym/MinTermSrpobfEnv/Data/3dim/DQN/")

env,model= dqn_runner_equivalent_functions(4,"/home/oytun/PycharmProjects/research/OpenAiGym/MinTermLpSrpobfEnv/Data/4dim/DQN/", KeyType.MONOMIAL_SET)

import random
from OpenAiGym.RLAlgorithmRunners.DqnRunner.DqnRunner import *
dimension = 3
two_to_power_dimension = 2**dimension
functions = random.sample(range(0, 2**two_to_power_dimension), int(2**two_to_power_dimension*0.75))
time_steps=200
root_dir="/home/oytun/PycharmProjects/research/OpenAiGym/MinTermLpSrpobfEnv/Data/" + str(dimension) + "dim/DQN/"
output_prefix="dimension_functions_random_range_0_to_256_size_192"
env,model= dqn_runner_functions(functions, dimension, time_steps, root_dir, output_prefix, KeyType.MONOMIAL_SET)


env,model= dqn_runner_functions(functions, dimension, time_steps, root_dir, output_prefix, KeyType.MONOMIAL_SET,model)

from OpenAiGym.RLAlgorithmRunners.Utils.DumpOutputs import *

dimension = 4
dir = "/home/oytun/PycharmProjects/research/OpenAiGym/MinTermLpSrpobfEnv/Data/4dim/DQN/4dimension_functions_random_range_0_to_65536_size_49152_2022-02-27 19:12:41.178066"
perf = load_json(dir,"performance_results")
mean,dev = dqn_runner_model_overall_performance(perf)

functions = load_json(dir,"function_each_episode")
functions = numpy.unique(functions).tolist()
model=dqn_load_model(dir)
env = env_creator(functions, dimension, KeyType.MONOMIAL_SET)


from OpenAiGym.RLAlgorithmRunners.RandomActionRunner.RandomActionRunner import random_action_runner
random_action_runner(5,"/home/oytun/PycharmProjects/research/OpenAiGym/MinTermSrpobfEnv/Data/5dim/RandomAction/2")
three_reward = random_action_runner(3)
four_reward = random_action_runner(4)

from OpenAiGym.RLAlgorithmRunners.RandomKVectorRunner.RandomKVectorRunner import random_k_vector_runner
random_k_vector_runner(5,"/home/oytun/PycharmProjects/research/OpenAiGym/MinTermSrpobfEnv/Data/5dim/RandomKVector")
three_reward = random_k_vector_runner(3)
four_reward = random_k_vector_runner(4)

dqn_runner(5,"/home/oytun/PycharmProjects/research/OpenAiGym/MinTermSrpobfEnv/Data/Visuals/5dim/DQN",[12,13])
